# Система оптимизации маршрутов доставки (VRPTW)

## Описание проекта

Система оптимизации маршрутов доставки - это современное веб-приложение для решения задачи маршрутизации транспортных средств с временными окнами (Vehicle Routing Problem with Time Windows, VRPTW). Система предназначена для логистических компаний и служб доставки, которым необходимо оптимизировать маршруты своих транспортных средств с учетом временных ограничений и различных параметров.

## Основная функциональность

### Ключевые возможности:
- **Оптимизация маршрутов** - автоматическое построение оптимальных маршрутов доставки с использованием алгоритмов OR-Tools
- **Адаптивная оптимизация** - динамическое перестроение маршрутов в реальном времени при изменении условий
- **Управление временными окнами** - учет временных ограничений для каждой точки доставки
- **Мониторинг в реальном времени** - отслеживание выполнения маршрутов и событий системы
- **Интеграция с картами** - использование Yandex Maps API для расчета расстояний и времени в пути
- **Прогнозирование ETA** - предсказание времени прибытия с учетом дорожной ситуации
- **Веб-интерфейс** - современная панель управления на React с интерактивными картами
- **WebSocket-уведомления** - мгновенные обновления состояния маршрутов
- **Система аналитики** - отчеты по эффективности доставок и производительности

### Технические особенности:
- Использование алгоритмов Google OR-Tools для решения VRPTW
- Архитектура на основе событий для адаптивной оптимизации
- RESTful API с автоматической документацией
- Поддержка WebSocket для real-time обновлений
- Интеграция с внешними картографическими сервисами

## Требования для запуска

### Backend (Python):
- Python 3.8 или выше
- pip (менеджер пакетов Python)
- SQLite (встроенная база данных)

### Frontend (Node.js):
- Node.js 16.0 или выше
- npm 7.0 или выше

### Системные требования:
- Операционная система: Windows 10/11, macOS 10.15+, Ubuntu 18.04+
- Оперативная память: минимум 4 ГБ, рекомендуется 8 ГБ
- Свободное место на диске: минимум 2 ГБ

### Внешние зависимости:
- Yandex Maps API ключ (опционально, для полной функциональности карт)
- Интернет-соединение для загрузки зависимостей

## Пошаговая инструкция по развертыванию

### 1. Подготовка окружения

Клонируйте репозиторий:
```bash
git clone <repository-url>
cd rut_miit
```

### 2. Настройка Backend

Перейдите в директорию backend:
```bash
cd backend
```

Создайте виртуальное окружение Python:
```bash
python -m venv venv
```

Активируйте виртуальное окружение:
- Windows: `venv\Scripts\activate`
- macOS/Linux: `source venv/bin/activate`

Установите зависимости:
```bash
pip install -r requirements.txt
```

Создайте файл конфигурации `.env`:
```bash
cp .env.example .env
```

Отредактируйте `.env` файл, добавив необходимые настройки:
```
DATABASE_URL=sqlite:///./vrptw.db
YANDEX_MAPS_API_KEY=your_yandex_maps_api_key_here
SECRET_KEY=your_secret_key_here
DEBUG=True
```

Инициализируйте базу данных:
```bash
python -c "from app.database import init_db; init_db()"
```

Запустите backend сервер:
```bash
python main.py
```

Backend будет доступен по адресу: `http://localhost:8000`

### 3. Настройка Frontend

Откройте новый терминал и перейдите в директорию frontend:
```bash
cd frontend
```

Установите зависимости:
```bash
npm install
```

Создайте файл конфигурации `.env.local`:
```
NEXT_PUBLIC_API_URL=http://localhost:8000
NEXT_PUBLIC_WS_URL=ws://localhost:8000
```

Запустите frontend сервер:
```bash
npm run dev
```

Frontend будет доступен по адресу: `http://localhost:3000`

## Примеры использования

### 1. Создание нового маршрута
1. Откройте веб-интерфейс по адресу `http://localhost:3000`
2. Нажмите кнопку "Создать новый маршрут"
3. Выберите заказы, транспортные средства и водителей
4. Нажмите "Оптимизировать маршрут"
5. Просмотрите результат на интерактивной карте

### 2. Мониторинг активных маршрутов
1. На главной панели отображаются активные маршруты
2. Кликните на маршрут для просмотра деталей
3. Отслеживайте прогресс выполнения в реальном времени

### 3. Использование API
Документация API доступна по адресам:
- Swagger UI: `http://localhost:8000/docs`
- ReDoc: `http://localhost:8000/redoc`

Пример запроса оптимизации через API:
```bash
curl -X POST "http://localhost:8000/api/v1/routes/optimize" \
  -H "Content-Type: application/json" \
  -d '{
    "order_ids": [1, 2, 3],
    "vehicle_ids": [1],
    "driver_ids": [1],
    "depot_location": {"lat": 55.7558, "lng": 37.6176}
  }'
```

### 4. Запуск симуляции
1. В разделе "Симуляция" выберите параметры
2. Нажмите "Запустить симуляцию"
3. Наблюдайте за процессом оптимизации в реальном времени

## Структура проекта

```
rut_miit/
├── backend/                 # Backend приложение (FastAPI)
│   ├── app/
│   │   ├── api/            # API маршруты
│   │   ├── models/         # Модели данных
│   │   ├── optimization/   # Алгоритмы оптимизации
│   │   └── services/       # Внешние сервисы
│   ├── main.py            # Точка входа приложения
│   └── requirements.txt   # Python зависимости
├── frontend/              # Frontend приложение (Next.js)
│   ├── src/
│   │   ├── components/    # React компоненты
│   │   ├── contexts/      # React контексты
│   │   └── hooks/         # Пользовательские хуки
│   └── package.json       # Node.js зависимости
└── README.md             # Документация проекта
```

## Устранение неполадок

### Проблемы с запуском backend:
- Убедитесь, что Python 3.8+ установлен
- Проверьте активацию виртуального окружения
- Убедитесь, что все зависимости установлены: `pip install -r requirements.txt`

### Проблемы с запуском frontend:
- Убедитесь, что Node.js 16+ установлен
- Очистите кэш npm: `npm cache clean --force`
- Удалите node_modules и переустановите: `rm -rf node_modules && npm install`

### Проблемы с базой данных:
- Убедитесь, что файл базы данных создан
- Проверьте права доступа к директории
- При необходимости пересоздайте базу данных

---
